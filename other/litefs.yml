fuse:
  dir: "${LITEFS_DIR}"

data:
  dir: "/data/litefs"

# proxy:
#   addr: ":${INTERNAL_PORT}"
#   target: "localhost:${PORT}"
#   db: "${DATABASE_FILENAME}"

lease:
  type: "static"
  # candidate: ${FLY_REGION == PRIMARY_REGION}
  # advertise-url: "http://${HOSTNAME}.vm.${FLY_APP_NAME}.internal:20202"
  # promote: true

  # consul:
  #   url: "${FLY_CONSUL_URL}"
  #   key: "casbytes-litefs/${FLY_APP_NAME}"

exec:
  - cmd: npm run migrate:prod
    if-candidate: true

  - cmd: sqlite3 $DATABASE_PATH "PRAGMA journal_mode=WAL;"
    if-candidate: true

  - cmd: npm start
